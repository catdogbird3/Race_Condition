<!doctype html>
<html lang="zh-TW" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç«¶æ…‹æ¢ä»¶èˆ‡ Mutex è§£æ±ºæ–¹æ¡ˆ</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .timeline-line {
            stroke-dasharray: 5, 5;
            animation: dash 20s linear infinite;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: -1000;
            }
        }
        
        .step-box {
            transition: all 0.3s ease;
        }
        
        .step-box.active {
            transform: scale(1.05);
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
        }
        
        .step-box.blocked {
            opacity: 0.3 !important;
            filter: grayscale(80%);
        }
        
        .memory-value {
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        
        .memory-value.highlight {
            transform: scale(1.1);
        }
        
        .mutex-indicator {
            transition: all 0.4s ease;
        }
        
        .mutex-locked {
            animation: pulse 1s ease-in-out;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .mode-btn {
            transition: all 0.3s ease;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="w-full h-full bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 overflow-auto">
   <div class="app-container mx-auto px-4 py-8 max-w-6xl"><!-- Header -->
    <div class="text-center mb-8">
     <h1 id="main-title" class="text-4xl font-bold text-white mb-2">ç«¶æ…‹æ¢ä»¶è¦–è¦ºåŒ–</h1>
     <p id="subtitle" class="text-xl text-purple-300">äº†è§£å¤šåŸ·è¡Œç·’åŒæ™‚å­˜å–å…±äº«è®Šæ•¸çš„å•é¡Œ</p>
    </div><!-- Mode Selector -->
    <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 mb-8 border border-white/20">
     <h3 class="text-white text-lg font-semibold mb-4 text-center">é¸æ“‡åŸ·è¡Œæ¨¡å¼</h3>
     <div class="flex flex-wrap gap-4 items-center justify-center"><button id="modeWithoutMutex" class="mode-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg border-4 border-red-300"> âŒ æ²’æœ‰ Mutexï¼ˆæœ‰å•é¡Œï¼‰ </button> <button id="modeWithMutex" class="mode-btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg border-4 border-transparent"> âœ… ä½¿ç”¨ Mutexï¼ˆæ­£ç¢ºï¼‰ </button>
     </div>
     <div id="modeDescription" class="mt-4 text-center text-purple-200 font-semibold">
      ç›®å‰æ¨¡å¼ï¼šæ²’æœ‰ Mutex ä¿è­·
     </div>
    </div><!-- Control Panel -->
    <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 mb-8 border border-white/20">
     <div class="flex flex-wrap gap-4 items-center justify-center"><button id="playBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg"> â–¶ é–‹å§‹åŸ·è¡Œ </button> <button id="resetBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg"> ğŸ”„ é‡ç½® </button>
      <div class="flex items-center gap-2"><label for="speedSlider" class="text-white font-semibold">é€Ÿåº¦:</label> <input type="range" id="speedSlider" min="500" max="3000" value="1500" step="500" class="w-32"> <span id="speedLabel" class="text-white">æ™®é€š</span>
      </div>
     </div>
    </div><!-- Mutex Indicator (only visible in mutex mode) -->
    <div id="mutexIndicator" class="hidden bg-white/10 backdrop-blur-md rounded-xl p-6 mb-8 border border-white/20">
     <h2 class="text-2xl font-bold text-white mb-4 text-center">ğŸ”’ Mutex ç‹€æ…‹</h2>
     <div class="flex justify-center items-center gap-8">
      <div class="text-center">
       <div class="text-purple-300 font-semibold mb-2">
        Mutex é–
       </div>
       <div id="mutexStatus" class="mutex-indicator bg-gray-500 text-white font-bold text-2xl px-8 py-4 rounded-lg">
        ğŸ”“ æœªé–å®š
       </div>
      </div>
      <div class="text-center">
       <div class="text-purple-300 font-semibold mb-2">
        æŒæœ‰è€…
       </div>
       <div id="mutexOwner" class="bg-gray-700 text-white font-bold text-2xl px-8 py-4 rounded-lg">
        ç„¡
       </div>
      </div>
     </div>
    </div><!-- Memory Display -->
    <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 mb-8 border border-white/20">
     <h2 class="text-2xl font-bold text-white mb-4 text-center">å…±äº«è¨˜æ†¶é«”ç‹€æ…‹</h2>
     <div class="flex justify-center items-center gap-8">
      <div class="text-center">
       <div class="text-purple-300 font-semibold mb-2">
        è®Šæ•¸ counter
       </div>
       <div id="counterValue" class="memory-value bg-yellow-500 text-black font-bold text-3xl px-8 py-4 rounded-lg">
        0
       </div>
      </div>
      <div class="text-center">
       <div class="text-purple-300 font-semibold mb-2">
        é æœŸçµæœ
       </div>
       <div class="bg-green-500 text-white font-bold text-3xl px-8 py-4 rounded-lg">
        2
       </div>
      </div>
     </div>
     <div id="warningMsg" class="hidden mt-4 bg-red-500 text-white p-4 rounded-lg text-center font-bold">
      âš ï¸ ç«¶æ…‹æ¢ä»¶ç™¼ç”Ÿï¼æœ€çµ‚å€¼ä¸æ­£ç¢ºï¼
     </div>
     <div id="successMsg" class="hidden mt-4 bg-green-500 text-white p-4 rounded-lg text-center font-bold">
      âœ… Mutex ä¿è­·æˆåŠŸï¼çµæœæ­£ç¢ºï¼
     </div>
    </div><!-- Timeline -->
    <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
     <h2 class="text-2xl font-bold text-white mb-6 text-center">åŸ·è¡Œæ™‚é–“åºåˆ—</h2><!-- Thread 0 -->
     <div class="mb-12">
      <div class="flex items-center mb-4">
       <div class="w-32 text-right pr-4"><span id="thread0-label" class="text-cyan-400 font-bold text-lg">åŸ·è¡Œç·’ 0</span>
       </div>
       <div class="flex-1">
        <svg width="100%" height="60"><line class="timeline-line" x1="0" y1="30" x2="100%" y2="30" stroke="#06b6d4" stroke-width="2" />
        </svg>
       </div>
      </div>
      <div id="thread0-steps" class="flex gap-4 ml-32 flex-wrap"><!-- Steps will be inserted here -->
      </div>
     </div><!-- Thread 1 -->
     <div>
      <div class="flex items-center mb-4">
       <div class="w-32 text-right pr-4"><span id="thread1-label" class="text-pink-400 font-bold text-lg">åŸ·è¡Œç·’ 1</span>
       </div>
       <div class="flex-1">
        <svg width="100%" height="60"><line class="timeline-line" x1="0" y1="30" x2="100%" y2="30" stroke="#ec4899" stroke-width="2" />
        </svg>
       </div>
      </div>
      <div id="thread1-steps" class="flex gap-4 ml-32 flex-wrap"><!-- Steps will be inserted here -->
      </div>
     </div>
    </div><!-- Explanation -->
    <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 mt-8 border border-white/20">
     <h2 class="text-2xl font-bold text-white mb-4">ğŸ’¡ è§£èªª</h2>
     <div id="explanationContent" class="text-purple-200 space-y-3 leading-relaxed"><!-- Content will be updated based on mode -->
     </div>
    </div><!-- Code Comparison -->
    <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 mt-8 border border-white/20">
     <h2 class="text-2xl font-bold text-white mb-4">ğŸ“ ç¨‹å¼ç¢¼æ¯”è¼ƒ</h2>
     <div class="grid md:grid-cols-2 gap-4"><!-- Without Mutex -->
      <div class="bg-black/30 p-4 rounded-lg">
       <h3 class="text-red-400 font-bold mb-2 text-lg">âŒ æ²’æœ‰ Mutex</h3>
       <pre class="text-sm text-gray-300"><code>void thread_function(void) {
    counter++;  // ä¸å®‰å…¨ï¼
}</code></pre>
      </div><!-- With Mutex -->
      <div class="bg-black/30 p-4 rounded-lg">
       <h3 class="text-green-400 font-bold mb-2 text-lg">âœ… ä½¿ç”¨ Mutex</h3>
       <pre class="text-sm text-gray-300"><code>void thread_function(void) {
    k_mutex_lock(&amp;my_mutex);
    counter++;  // å®‰å…¨ï¼
    k_mutex_unlock(&amp;my_mutex);
}</code></pre>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        const defaultConfig = {
            main_title: "ç«¶æ…‹æ¢ä»¶è¦–è¦ºåŒ–",
            subtitle: "äº†è§£å¤šåŸ·è¡Œç·’åŒæ™‚å­˜å–å…±äº«è®Šæ•¸çš„å•é¡Œ",
            thread0_label: "åŸ·è¡Œç·’ 0",
            thread1_label: "åŸ·è¡Œç·’ 1"
        };

        // Steps without mutex
        const stepsWithoutMutex = [
            { thread: 0, action: "è®€å–", desc: "è®€å– counter = 0", color: "bg-cyan-500", value: 0 },
            { thread: 1, action: "è®€å–", desc: "è®€å– counter = 0", color: "bg-pink-500", value: 0 },
            { thread: 0, action: "è¨ˆç®—", desc: "0 + 1 = 1", color: "bg-cyan-600", value: null },
            { thread: 1, action: "è¨ˆç®—", desc: "0 + 1 = 1", color: "bg-pink-600", value: null },
            { thread: 0, action: "å¯«å…¥", desc: "å¯«å…¥ counter = 1", color: "bg-cyan-700", value: 1 },
            { thread: 1, action: "å¯«å…¥", desc: "å¯«å…¥ counter = 1", color: "bg-pink-700", value: 1 }
        ];

        // Steps with mutex
        const stepsWithMutex = [
            { thread: 0, action: "ğŸ”’ é–å®š", desc: "å–å¾— Mutex", color: "bg-cyan-500", mutex: "lock", owner: 0 },
            { thread: 0, action: "è®€å–", desc: "è®€å– counter = 0", color: "bg-cyan-500", value: 0 },
            { thread: 1, action: "â³ ç­‰å¾…", desc: "ç­‰å¾… Mutex", color: "bg-pink-500", mutex: "wait", blocked: true },
            { thread: 0, action: "è¨ˆç®—", desc: "0 + 1 = 1", color: "bg-cyan-600", value: null },
            { thread: 0, action: "å¯«å…¥", desc: "å¯«å…¥ counter = 1", color: "bg-cyan-700", value: 1 },
            { thread: 0, action: "ğŸ”“ è§£é–", desc: "é‡‹æ”¾ Mutex", color: "bg-cyan-700", mutex: "unlock" },
            { thread: 1, action: "ğŸ”’ é–å®š", desc: "å–å¾— Mutex", color: "bg-pink-500", mutex: "lock", owner: 1 },
            { thread: 1, action: "è®€å–", desc: "è®€å– counter = 1", color: "bg-pink-500", value: 1 },
            { thread: 1, action: "è¨ˆç®—", desc: "1 + 1 = 2", color: "bg-pink-600", value: null },
            { thread: 1, action: "å¯«å…¥", desc: "å¯«å…¥ counter = 2", color: "bg-pink-700", value: 2 },
            { thread: 1, action: "ğŸ”“ è§£é–", desc: "é‡‹æ”¾ Mutex", color: "bg-pink-700", mutex: "unlock" }
        ];

        let currentMode = 'without'; // 'without' or 'with'
        let steps = stepsWithoutMutex;
        let currentStep = -1;
        let isPlaying = false;
        let animationSpeed = 1500;
        let animationTimer = null;

        async function onConfigChange(config) {
            document.getElementById('main-title').textContent = config.main_title || defaultConfig.main_title;
            document.getElementById('subtitle').textContent = config.subtitle || defaultConfig.subtitle;
            document.getElementById('thread0-label').textContent = config.thread0_label || defaultConfig.thread0_label;
            document.getElementById('thread1-label').textContent = config.thread1_label || defaultConfig.thread1_label;
        }

        function updateExplanation() {
            const explanationContent = document.getElementById('explanationContent');
            if (currentMode === 'without') {
                explanationContent.innerHTML = `
                    <p><strong class="text-yellow-400">å•é¡Œæ ¸å¿ƒï¼š</strong>ã€Œè®€å–-ä¿®æ”¹-å¯«å…¥ã€ä¸æ˜¯åŸå­æ“ä½œï¼ˆatomic operationï¼‰</p>
                    <p>ç•¶å…©å€‹åŸ·è¡Œç·’åŒæ™‚åŸ·è¡Œ <code class="bg-black/30 px-2 py-1 rounded text-cyan-400">counter++</code> æ™‚ï¼š</p>
                    <ol class="list-decimal list-inside space-y-2 ml-4">
                        <li>åŸ·è¡Œç·’ 0 è®€å– counter = 0</li>
                        <li>åŸ·è¡Œç·’ 1 ä¹Ÿè®€å– counter = 0ï¼ˆé‚„æ²’è¢«æ›´æ–°ï¼ï¼‰</li>
                        <li>åŸ·è¡Œç·’ 0 è¨ˆç®— 0 + 1 = 1ï¼Œå¯«å…¥ counter</li>
                        <li>åŸ·è¡Œç·’ 1 è¨ˆç®— 0 + 1 = 1ï¼Œå†æ¬¡å¯«å…¥ counter</li>
                        <li><strong class="text-red-400">çµæœï¼šcounter = 1ï¼ˆæ‡‰è©²æ˜¯ 2ï¼ï¼‰</strong></li>
                    </ol>
                `;
            } else {
                explanationContent.innerHTML = `
                    <p><strong class="text-green-400">Mutex å¦‚ä½•è§£æ±ºå•é¡Œï¼š</strong></p>
                    <ol class="list-decimal list-inside space-y-2 ml-4">
                        <li><strong class="text-cyan-400">åŸ·è¡Œç·’ 0</strong> å…ˆé–å®š Mutexï¼Œç²å¾—ç¨ä½”å­˜å–æ¬Š</li>
                        <li><strong class="text-pink-400">åŸ·è¡Œç·’ 1</strong> å˜—è©¦é–å®šä½†è¢«é˜»æ“‹ï¼Œå¿…é ˆç­‰å¾…</li>
                        <li><strong class="text-cyan-400">åŸ·è¡Œç·’ 0</strong> å®Œæ•´åŸ·è¡Œï¼šè®€å–(0) â†’ è¨ˆç®—(+1) â†’ å¯«å…¥(1)</li>
                        <li><strong class="text-cyan-400">åŸ·è¡Œç·’ 0</strong> è§£é– Mutex</li>
                        <li><strong class="text-pink-400">åŸ·è¡Œç·’ 1</strong> ç¾åœ¨å¯ä»¥é–å®š Mutex</li>
                        <li><strong class="text-pink-400">åŸ·è¡Œç·’ 1</strong> å®Œæ•´åŸ·è¡Œï¼šè®€å–(1) â†’ è¨ˆç®—(+1) â†’ å¯«å…¥(2)</li>
                        <li><strong class="text-green-400">çµæœï¼šcounter = 2ï¼ˆæ­£ç¢ºï¼ï¼‰</strong></li>
                    </ol>
                    <p class="mt-4"><strong class="text-yellow-400">é—œéµæ¦‚å¿µï¼š</strong>Mutex ç¢ºä¿ã€Œè‡¨ç•Œå€åŸŸã€(critical section) ä¸€æ¬¡åªæœ‰ä¸€å€‹åŸ·è¡Œç·’å¯ä»¥é€²å…¥</p>
                `;
            }
        }

        function initializeTimeline() {
            const thread0Container = document.getElementById('thread0-steps');
            const thread1Container = document.getElementById('thread1-steps');
            
            thread0Container.innerHTML = '';
            thread1Container.innerHTML = '';
            
            steps.forEach((step, index) => {
                const stepBox = document.createElement('div');
                stepBox.className = `step-box ${step.color} text-white p-4 rounded-lg text-center min-w-32 shadow-lg opacity-50`;
                stepBox.id = `step-${index}`;
                stepBox.innerHTML = `
                    <div class="font-bold text-lg">${step.action}</div>
                    <div class="text-sm mt-1">${step.desc}</div>
                `;
                
                if (step.thread === 0) {
                    thread0Container.appendChild(stepBox);
                } else {
                    thread1Container.appendChild(stepBox);
                }
            });
        }

        function updateStep(stepIndex) {
            document.querySelectorAll('.step-box').forEach(box => {
                box.classList.remove('active', 'blocked');
                box.style.opacity = '0.5';
            });
            
            if (stepIndex >= 0 && stepIndex < steps.length) {
                const step = steps[stepIndex];
                const stepBox = document.getElementById(`step-${stepIndex}`);
                
                if (step.blocked) {
                    stepBox.classList.add('blocked');
                } else {
                    stepBox.classList.add('active');
                    stepBox.style.opacity = '1';
                }
                
                const counterValue = document.getElementById('counterValue');
                const warningMsg = document.getElementById('warningMsg');
                const successMsg = document.getElementById('successMsg');
                
                // Update mutex status
                if (currentMode === 'with') {
                    const mutexStatus = document.getElementById('mutexStatus');
                    const mutexOwner = document.getElementById('mutexOwner');
                    
                    if (step.mutex === 'lock') {
                        mutexStatus.textContent = 'ğŸ”’ å·²é–å®š';
                        mutexStatus.className = 'mutex-indicator mutex-locked bg-red-600 text-white font-bold text-2xl px-8 py-4 rounded-lg';
                        mutexOwner.textContent = step.owner === 0 ? 'åŸ·è¡Œç·’ 0' : 'åŸ·è¡Œç·’ 1';
                        mutexOwner.className = step.owner === 0 ? 'bg-cyan-600 text-white font-bold text-2xl px-8 py-4 rounded-lg' : 'bg-pink-600 text-white font-bold text-2xl px-8 py-4 rounded-lg';
                    } else if (step.mutex === 'unlock') {
                        mutexStatus.textContent = 'ğŸ”“ æœªé–å®š';
                        mutexStatus.className = 'mutex-indicator bg-gray-500 text-white font-bold text-2xl px-8 py-4 rounded-lg';
                        mutexOwner.textContent = 'ç„¡';
                        mutexOwner.className = 'bg-gray-700 text-white font-bold text-2xl px-8 py-4 rounded-lg';
                    } else if (step.mutex === 'wait') {
                        // Show waiting state
                        stepBox.style.opacity = '0.5';
                    }
                }
                
                // Update counter value
                if (step.value !== null && step.value !== undefined) {
                    counterValue.textContent = step.value;
                    counterValue.className = `memory-value ${step.thread === 0 ? 'bg-cyan-500' : 'bg-pink-500'} text-white font-bold text-3xl px-8 py-4 rounded-lg highlight`;
                    
                    setTimeout(() => {
                        counterValue.classList.remove('highlight');
                    }, 300);
                } else if (step.action === 'è¨ˆç®—') {
                    counterValue.className = 'memory-value bg-yellow-500 text-black font-bold text-3xl px-8 py-4 rounded-lg';
                }
                
                // Show final message
                if (stepIndex === steps.length - 1) {
                    if (currentMode === 'without') {
                        warningMsg.classList.remove('hidden');
                        successMsg.classList.add('hidden');
                    } else {
                        successMsg.classList.remove('hidden');
                        warningMsg.classList.add('hidden');
                    }
                }
            }
        }

        function playAnimation() {
            if (currentStep >= steps.length - 1) {
                currentStep = -1;
                resetDisplay();
            }
            
            currentStep++;
            updateStep(currentStep);
            
            if (currentStep < steps.length - 1 && isPlaying) {
                animationTimer = setTimeout(playAnimation, animationSpeed);
            } else {
                isPlaying = false;
                document.getElementById('playBtn').textContent = 'â–¶ é–‹å§‹åŸ·è¡Œ';
            }
        }

        function resetDisplay() {
            document.getElementById('counterValue').textContent = '0';
            document.getElementById('counterValue').className = 'memory-value bg-yellow-500 text-black font-bold text-3xl px-8 py-4 rounded-lg';
            document.getElementById('warningMsg').classList.add('hidden');
            document.getElementById('successMsg').classList.add('hidden');
            
            if (currentMode === 'with') {
                document.getElementById('mutexStatus').textContent = 'ğŸ”“ æœªé–å®š';
                document.getElementById('mutexStatus').className = 'mutex-indicator bg-gray-500 text-white font-bold text-2xl px-8 py-4 rounded-lg';
                document.getElementById('mutexOwner').textContent = 'ç„¡';
                document.getElementById('mutexOwner').className = 'bg-gray-700 text-white font-bold text-2xl px-8 py-4 rounded-lg';
            }
        }

        function resetAnimation() {
            isPlaying = false;
            currentStep = -1;
            if (animationTimer) {
                clearTimeout(animationTimer);
            }
            resetDisplay();
            document.getElementById('playBtn').textContent = 'â–¶ é–‹å§‹åŸ·è¡Œ';
            
            document.querySelectorAll('.step-box').forEach(box => {
                box.classList.remove('active', 'blocked');
                box.style.opacity = '0.5';
            });
        }

        function switchMode(mode) {
            currentMode = mode;
            steps = mode === 'without' ? stepsWithoutMutex : stepsWithMutex;
            
            // Update button styles
            const withoutBtn = document.getElementById('modeWithoutMutex');
            const withBtn = document.getElementById('modeWithMutex');
            
            if (mode === 'without') {
                withoutBtn.className = 'mode-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg border-4 border-red-300';
                withBtn.className = 'mode-btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg border-4 border-transparent';
                document.getElementById('modeDescription').textContent = 'ç›®å‰æ¨¡å¼ï¼šæ²’æœ‰ Mutex ä¿è­·';
                document.getElementById('mutexIndicator').classList.add('hidden');
            } else {
                withoutBtn.className = 'mode-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg border-4 border-transparent';
                withBtn.className = 'mode-btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg border-4 border-green-300';
                document.getElementById('modeDescription').textContent = 'ç›®å‰æ¨¡å¼ï¼šä½¿ç”¨ Mutex ä¿è­·';
                document.getElementById('mutexIndicator').classList.remove('hidden');
            }
            
            resetAnimation();
            initializeTimeline();
            updateExplanation();
        }

        document.getElementById('modeWithoutMutex').addEventListener('click', (e) => {
            e.preventDefault();
            switchMode('without');
        });

        document.getElementById('modeWithMutex').addEventListener('click', (e) => {
            e.preventDefault();
            switchMode('with');
        });

        document.getElementById('playBtn').addEventListener('click', (e) => {
            e.preventDefault();
            if (!isPlaying) {
                isPlaying = true;
                document.getElementById('playBtn').textContent = 'â¸ æš«åœ';
                playAnimation();
            } else {
                isPlaying = false;
                document.getElementById('playBtn').textContent = 'â–¶ ç¹¼çºŒ';
                if (animationTimer) {
                    clearTimeout(animationTimer);
                }
            }
        });

        document.getElementById('resetBtn').addEventListener('click', (e) => {
            e.preventDefault();
            resetAnimation();
        });

        document.getElementById('speedSlider').addEventListener('input', (e) => {
            animationSpeed = parseInt(e.target.value);
            const speedLabel = document.getElementById('speedLabel');
            if (animationSpeed <= 1000) {
                speedLabel.textContent = 'å¿«é€Ÿ';
            } else if (animationSpeed <= 2000) {
                speedLabel.textContent = 'æ™®é€š';
            } else {
                speedLabel.textContent = 'æ…¢é€Ÿ';
            }
        });

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [],
                    borderables: [],
                    fontEditable: undefined,
                    fontSizeable: undefined
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["main_title", config.main_title || defaultConfig.main_title],
                    ["subtitle", config.subtitle || defaultConfig.subtitle],
                    ["thread0_label", config.thread0_label || defaultConfig.thread0_label],
                    ["thread1_label", config.thread1_label || defaultConfig.thread1_label]
                ])
            });
            onConfigChange(window.elementSdk.config);
        } else {
            onConfigChange(defaultConfig);
        }

        initializeTimeline();
        updateExplanation();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ab3d13e0328b307',t:'MTc2NTI3NjEyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
